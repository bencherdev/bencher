import ShellForm from "../shell-form.mdx";
import ExecForm from "../exec-form.mdx";

## 벤치마크 명령

`bencher run`의 첫 번째 인수는 선택적 벤치마크 명령입니다.
이 명령은 벤치마크 하니스(benchmark harness)를 호출하는 데 사용됩니다.
또한 `BENCHER_CMD` 환경 변수로 설정할 수 있습니다.
기본적으로 이 명령은 셸에서 실행되며,
이는 [`--shell`][shell option] 및 [`--flag`][flag option] 옵션으로 구성할 수 있습니다.
명령의 출력은 [benchmark harness adapter][benchmark harness adapters]로 파싱되며,
이는 [`--adapter`][adapter option] 옵션으로 설정할 수 있습니다.
그러나 벤치마크 하니스가 파일로 출력을 내보내는 경우에는 출력 파일 경로를 지정하기 위해 [`--file`][file option] 옵션도 사용해야 합니다.
또는 출력 내용 대신 출력 파일의 크기(예: 바이너리 크기)를 추적하려면 출력 파일 경로를 지정하기 위해 [`--file-size`][file size option] 옵션을 사용하세요.

명령을 셸에서 실행하지 않으려면 `--exec` 플래그를 사용하거나 명령에 대한 추가 인수를 `bencher run`에 추가 인수로 제공하면 됩니다.

셸 형식:
<ShellForm />

Exec 형식:
<ExecForm />

벤치마크 명령은 [`--iter`][iter option] 옵션을 사용하여 여러 번 실행할 수 있으며,
그 결과는 [`--fold`][fold option] 옵션을 사용해 단일 결과로 합칠 수 있습니다.
만약 반복(iteration) 중 하나라도 실패하면,
[`--allow-failure`][allow failure flag] 플래그가 설정되어 있지 않는 한 전체 명령이 실패한 것으로 간주됩니다.

벤치마크 명령이 지정되지 않았지만 [`--file`][file option] 옵션이 지정되어 있으면,
`bencher run`은 대신 출력 파일 경로에서 읽기만 합니다.
마찬가지로 벤치마크 명령이 지정되지 않았지만 [`--file-size`][file size option] 옵션이 지정되어 있으면,
`bencher run`은 지정된 파일 경로의 파일 크기만 읽습니다.
`--file` 및 `--file-size` 옵션은 여러 번 지정하여 여러 파일에서 읽을 수 있습니다.

<blockquote>
<details>
  <summary>🐰 <code>-&#8288;-file</code> 옵션 사용 팁</summary>
  <code>-&#8288;-file</code> 옵션은 파일에서 벤치마크 결과를 읽을 때 사용할 수 있습니다.
  여러 파일에서 읽으려면 <code>-&#8288;-file</code> 옵션을 여러 번 지정할 수 있습니다.
  옵션을 여러 번 지정하면 각 파일이 벤치마크 명령의 별도 <code>iteration</code>으로 간주됩니다.
  표시될 때 이 결과들은 각각 별도의 표로 출력됩니다.

  결과들을 하나의 <code>iteration</code>으로 합치려면 <code>-&#8288;-iter</code> 옵션을 <code>1</code>로 설정하고 <code>-&#8288;-fold</code> 옵션을 집계 함수 중 <code>min</code>, <code>max</code> 또는 <code>median</code>으로 설정하면 됩니다.
  그러면 결과들이 하나의 <code>iteration</code>으로 합쳐져 하나의 표로 표시됩니다.
  <b>절대</b> <code>-&#8288;-fold</code> 옵션을 <code>mean</code>으로 설정하지 마세요.
</details>
</blockquote>

벤치마크 명령도, [`--file`][file option] 옵션도, [`--file-size`][file size option] 옵션도 지정되지 않은 경우,
`bencher run`은 대신 `stdin`에서 읽습니다.
이를 통해 다른 명령의 출력을 파일로 저장하거나 파이프를 통해 `bencher run`으로 전달할 수 있습니다.

[benchmark harness adapters]: /ko/docs/explanation/adapters/

[shell option]: #--shell-shell
[flag option]: #--flag-flag
[adapter option]: #--adapter-adapter
[file option]: #--file-file
[file size option]: #--file-size-file
[iter option]: #--iter-iter
[fold option]: #--fold-fold
[allow failure flag]: #--allow-failure