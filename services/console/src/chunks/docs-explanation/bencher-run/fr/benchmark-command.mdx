import ShellForm from "../shell-form.mdx";
import ExecForm from "../exec-form.mdx";

## Commande de benchmark

Le premier argument de `bencher run` est la commande de benchmark optionnelle.
Il s'agit de la commande qui sera ex√©cut√©e et qui lancera votre harness de benchmark.
Elle peut aussi √™tre d√©finie via la variable d'environnement `BENCHER_CMD`.
Par d√©faut, cette commande est ex√©cut√©e dans un shell, qui peut √™tre configur√© avec les options [`--shell`][shell option] et [`--flag`][flag option].
Sa sortie est analys√©e par un [adaptateur pour le harness de benchmark][benchmark harness adapters], qui peut √™tre d√©fini avec l'option [`--adapter`][adapter option].
Cependant, si le harness de benchmark √©crit dans un fichier, l'option [`--file`][file option] doit √©galement √™tre utilis√©e pour sp√©cifier le chemin du fichier de sortie.
Alternativement, pour suivre la taille du fichier de sortie (par ex. la taille d'un binaire) plut√¥t que son contenu, utilisez l'option [`--file-size`][file size option] pour indiquer le chemin du fichier.

Si vous pr√©f√©rez que la commande ne soit pas ex√©cut√©e dans un shell, vous pouvez utiliser l'option `--exec` ou simplement fournir des arguments suppl√©mentaires √† votre commande via `bencher run`.

Forme Shell :
<ShellForm />

Forme Exec :
<ExecForm />

La commande de benchmark peut √™tre ex√©cut√©e plusieurs fois en utilisant l'option [`--iter`][iter option], et ces r√©sultats peuvent √™tre agr√©g√©s en un seul r√©sultat avec l'option [`--fold`][fold option].
Si l'une des it√©rations √©choue, la commande enti√®re est consid√©r√©e comme ayant √©chou√©, sauf si le drapeau [`--allow-failure`][allow failure flag] est activ√©.

Si la commande de benchmark n'est pas sp√©cifi√©e mais que l'option [`--file`][file option] l'est, alors `bencher run` lira simplement depuis le chemin du fichier de sortie indiqu√©.
De m√™me, si la commande n'est pas sp√©cifi√©e mais que l'option [`--file-size`][file size option] l'est, `bencher run` lira simplement la taille du fichier au chemin donn√©.
Les options `--file` et `--file-size` peuvent √™tre sp√©cifi√©es plusieurs fois pour lire plusieurs fichiers.

<blockquote>
<details>
  <summary>üê∞ Conseils pour l'utilisation de l'option <code>-&#8288;-file</code></summary>
  L'option <code>-&#8288;-file</code> peut √™tre utilis√©e pour lire des r√©sultats de benchmark depuis un fichier.
  Vous pouvez sp√©cifier l'option <code>-&#8288;-file</code> plusieurs fois pour lire plusieurs fichiers.
  Si vous sp√©cifiez l'option <code>-&#8288;-file</code> plusieurs fois,
  alors chaque fichier sera consid√©r√© comme une <code>it√©ration</code> distincte de la commande de benchmark.
  Lors de l'affichage, ces r√©sultats seront pr√©sent√©s dans des tableaux s√©par√©s.

  Si vous souhaitez combiner ces r√©sultats en une seule <code>it√©ration</code>,
  vous pouvez r√©gler l'option <code>-&#8288;-iter</code> sur <code>1</code>
  et d√©finir l'option <code>-&#8288;-fold</code> sur l'une des fonctions d'agr√©gation <code>min</code>, <code>max</code> ou <code>median</code>.
  Cela regroupera les r√©sultats en une seule <code>it√©ration</code> et les affichera dans un seul tableau.
  Ne r√©glez <b>pas</b> l'option <code>-&#8288;-fold</code> sur <code>mean</code>.
</details>
</blockquote>

Si ni la commande de benchmark, ni l'option [`--file`][file option], ni l'option [`--file-size`][file size option] ne sont sp√©cifi√©es, `bencher run` lira depuis `stdin`.
Cela vous permet d'enregistrer la sortie d'une autre commande dans un fichier ou de la transmettre via un pipe √† `bencher run`.

[benchmark harness adapters]: /fr/docs/explanation/adapters/

[shell option]: #--shell-shell
[flag option]: #--flag-flag
[adapter option]: #--adapter-adapter
[file option]: #--file-file
[file size option]: #--file-size-file
[iter option]: #--iter-iter
[fold option]: #--fold-fold
[allow failure flag]: #--allow-failure